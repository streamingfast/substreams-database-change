## Substreams Crates Release Instructions

### Instructions

> *Important* Do not forget to replace `${version}` by your real version like `0.1.3` in the commands below!

- Ensure you are in a clean and pushed Git state
- Find & replace all occurrences of Regex `^version = "[^"]+"` in all `Cargo.toml` files to `version = "${version}"`
- Find & replace all occurrences of Regex `^  version: [^"]+` in all `substreams.yaml` files to `  version: v${version}` (**Spaces are important**)
- Ensure build `cargo build --release` and tests `cargo test --target aarch64-apple-darwin` (adapt `--target` value to fit your machine's architecture)
- Update the [CHANGELOG.md](CHANGELOG.md) to update the `## Unreleased` header to become `## [${version}](https://github.com/streamingfast/substreams-sink-database-changes/releases/tag/v${version})`
- Ensure that Keybase is running and you are logged in
- Ensure that `cargo login` has been done in your terminal
- Commit everything with message `Preparing release of ${version}`.
- `./bin/release.sh -f v${version}`
- If everything goes well, `crates.io` will be update and Git should be in a synced state (the release script does a `git push` of the branch and the tag).
- Go to https://github.com/streamingfast/substreams-rs/releases/tag/v${version} and update the release notes, use content of section `## [v${version}]` in [docs/release-notes/change-log.md](../docs/release-notes/change-log.md), edit GitHub release and paste content before commits listing, keep both:

  ```
  ## Changelog

  <Content from 'CHANGELOG.md' here>

  ### Commits

  <Auto-generated commits listing>
  ```

- Update the [CHANGELOG.md](CHANGELOG.md) adding `## Unreleased` header on top of latest released section.
- Commit everything with message `Preparing next unreleased version`.
